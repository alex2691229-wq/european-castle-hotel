# æ­å ¡å•†å‹™æ±½è»Šæ—…é¤¨ - Clean Rebuild TODO

## ğŸŸ¢ Phase 1ï¼šå…¨æ–°é‡è£½ï¼ˆClean Rebuildï¼‰- å·²å®Œæˆ

- [x] å‰µå»ºæ–°çš„ GitHub Branchï¼ˆclean-startï¼‰
- [x] åˆªé™¤æ‰€æœ‰æ¸¬è©¦æ–‡ä»¶ï¼ˆ*.test.tsï¼‰
- [x] åˆªé™¤åˆå§‹åŒ–è…³æœ¬å’Œå·¥ä½œå ±å‘Š
- [x] é‡å¯« api/db.tsï¼ˆæ­£ç¢ºè®€å–ç’°å¢ƒè®Šæ•¸ï¼ŒåŒ…å« SSL é…ç½®ï¼‰
- [x] é‡å¯« api/index.tsï¼ˆåªä¿ç•™é¦–é æˆ¿å‹å’Œå¥åº·æª¢æŸ¥ï¼Œç§»é™¤ @ts-nocheckï¼‰
- [x] æ·»åŠ æ­£ç¢ºçš„ TypeScript å‹åˆ¥å®šç¾©
- [x] æœ¬åœ°ç·¨è­¯æˆåŠŸï¼ˆç„¡ TypeScript éŒ¯èª¤ï¼‰

## ğŸŸ¢ Phase 2ï¼šé¦–é æˆ¿å‹é¡¯ç¤ºå’Œå¥åº·æª¢æŸ¥ - å·²å®Œæˆ

- [x] å¯¦ä½œ /api/health/db ç«¯é»ï¼ˆè¿”å› "connected"ï¼‰
- [x] å¯¦ä½œ /api/room-types ç«¯é»ï¼ˆå¾è³‡æ–™åº«è®€å–æˆ¿å‹ï¼‰
- [x] é¦–é æ­£å¸¸é¡¯ç¤º
- [x] æœ¬åœ°æ¸¬è©¦æˆåŠŸ

## ğŸŸ¡ Phase 3ï¼šéƒ¨ç½²åˆ° Vercel - é€²è¡Œä¸­

- [ ] æ¨é€ clean-start branch åˆ° GitHub
- [ ] åœ¨ Vercel ä¸­è¨­ç½® clean-start branch ç‚ºéƒ¨ç½²ä¾†æº
- [ ] é©—è­‰ Vercel éƒ¨ç½²æˆåŠŸ
- [ ] é©—è­‰ /api/health/db è¿”å› "connected"
- [ ] é©—è­‰é¦–é æˆ¿å‹é¡¯ç¤ºæ­£å¸¸

## âšª Phase 4ï¼šå¾ŒçºŒåŠŸèƒ½é–‹ç™¼ï¼ˆå¾…é©—è­‰éƒ¨ç½²å¾Œé–‹å§‹ï¼‰

- [ ] å¯¦ä½œç™»å…¥åŠŸèƒ½
- [ ] å¯¦ä½œè¨‚æˆ¿æµç¨‹
- [ ] å¯¦ä½œç®¡ç†å¾Œå°
- [ ] å¯¦ä½œå…¶ä»–åŠŸèƒ½

---

## é—œéµæ±ºå®š

1. **ä½¿ç”¨ clean-start branch** - å®Œå…¨éš”é›¢æ–°ä»£ç¢¼ï¼Œé¿å…èˆŠä»£ç¢¼å¹²æ“¾
2. **åªè®€å–ç’°å¢ƒè®Šæ•¸** - ä¸ç¡¬ç·¨ç¢¼ä»»ä½•æ•æ„Ÿä¿¡æ¯
3. **åŒ…å« SSL é…ç½®** - `{ rejectUnauthorized: false }`
4. **ç§»é™¤æ‰€æœ‰ @ts-nocheck** - ç¢ºä¿ TypeScript å‹åˆ¥å®‰å…¨
5. **åˆ†éšå¯¦ä½œ** - å…ˆé©—è­‰åŸºç¤åŠŸèƒ½ï¼Œå†é–‹ç™¼å¾ŒçºŒåŠŸèƒ½

---

## ç’°å¢ƒè®Šæ•¸è¦æ±‚

```
DATABASE_URL=mysql://user:password@gateway01.ap-northeast-1.prod.aws.tidbcloud.com:4000/test?ssl=true
```

---

## é©—è­‰æª¢æŸ¥æ¸…å–®

### æœ¬åœ°é©—è­‰ âœ…
- [x] é¦–é æ­£å¸¸é¡¯ç¤º
- [x] /api/health/db è¿”å› "connected"
- [x] ç·¨è­¯æˆåŠŸï¼ˆç„¡ TypeScript éŒ¯èª¤ï¼‰

### Vercel é©—è­‰ â³
- [ ] éƒ¨ç½²æˆåŠŸ
- [ ] /api/health/db è¿”å› "connected"
- [ ] é¦–é æˆ¿å‹æ­£å¸¸é¡¯ç¤º
- [ ] ç„¡ TypeScript å ±éŒ¯


## ğŸŸ¢ æ–°åŠŸèƒ½éœ€æ±‚ - å·²å®Œæˆ

- [x] åœ¨é¦–é å°èˆªæ¬„æ·»åŠ ã€Œæœ€æ–°æ¶ˆæ¯ã€æŒ‰éˆ•
- [x] å‰µå»º /news é é¢é¡¯ç¤ºæœ€æ–°æ¶ˆæ¯
- [x] å¾æ•¸æ“šåº«è®€å–æ¶ˆæ¯å…§å®¹
- [x] æœ¬åœ°æ¸¬è©¦é©—è­‰
- [ ] æ¨é€åˆ° clean-start branch


## ğŸŸ¢ å¿«é€Ÿä¿®è¤‡ - tRPC æ ¸å¿ƒæ¶æ§‹ - å·²å®Œæˆ

- [x] æ¢è¤‡ tRPC Server é…ç½®
- [x] å¯¦ç¾ auth.login ç«¯é»
- [x] å¯¦ç¾ roomTypes.list ç«¯é»
- [x] ç¢ºä¿å‹åˆ¥å®‰å…¨ï¼ˆç„¡ @ts-nocheckï¼‰
- [ ] éƒ¨ç½²é©—è­‰


## æœ€å°åŒ–ä¿®å¾© - åªä¿ç•™åŸºæœ¬åŠŸèƒ½ - å·²å®Œæˆ

- [x] åˆªé™¤èˆŠçš„è©¦é©—æ–‡ä»¶ï¼ˆdb-simple.ts, index-simple.tsï¼‰
- [x] è¨»è§£æ‰æ‰€æœ‰éæ ¸å¿ƒåŠŸèƒ½ï¼ˆNews, Facilities, Bookings ç­‰ï¼‰
- [x] åªä¿ç•™ auth.login å’Œ roomTypes.list
- [x] pnpm build æˆåŠŸï¼Œç„¡ TypeScript éŒ¯èª¤
- [x] æœ¬åœ°æ¸¬è©¦æˆåŠŸï¼ˆé¦–é ã€æˆ¿å‹ APIï¼‰
- [ ] éƒ¨ç½²åˆ° Vercel


## ä¿®å¾©ç·¨è­¯éŒ¯èª¤ - å·²å®Œæˆ

- [x] ç§»é™¤ package.json ä¸­çš„ || true
- [x] åˆªé™¤ api/db-init-simple.ts
- [x] ä¿®å¾© api/db.ts çš„ Null æª¢æŸ¥å’Œå‹åˆ¥
- [x] ä¿®å¾© api/index.ts çš„ Express å‹åˆ¥
- [x] pnpm build æˆåŠŸï¼Œç„¡ TypeScript éŒ¯èª¤
- [x] æœ¬åœ°æ¸¬è©¦æˆåŠŸï¼ˆé¦–é ã€tRPC ç«¯é»ï¼‰
- [ ] éƒ¨ç½²åˆ° Vercel


## ğŸŸ¢ ç·Šæ€¥é‡æ§‹ - Vercel Serverless åŸç”Ÿå¯«æ³• - å·²å®Œæˆ

- [x] é‡å¯« api/index.ts ä½¿ç”¨ Vercel å®˜æ–¹ Serverless å¯«æ³•
- [x] ä¿®è¤‡ api/db.ts çš„ Null æª¢æŸ¥ï¼ˆä½¿ç”¨ Getterï¼‰
- [x] ä¿®è¤‡ React å°å…¥å•é¡Œï¼ˆlogin.tsx, index.tsxï¼‰
- [x] ç¢ºä¿ TypeScript ç·¨è­¯å®Œå…¨æˆåŠŸï¼ˆnpx tsc --noEmitï¼‰
- [x] é©—è­‰ /api/trpc/roomTypes.list è¿”å›æœ‰æ•ˆ JSON
- [ ] éƒ¨ç½²åˆ° Vercel ä¸¦é©—è­‰


## ğŸŸ¡ Phase 5ï¼šå®Œæ•´åŠŸèƒ½é›†æˆ - é€²è¡Œä¸­

### 5.1 è¨­æ–½å’Œæ–°èæ•¸æ“š
- [x] æª¢æŸ¥ facilities è¡¨æ˜¯å¦å­˜åœ¨ä¸¦æœ‰æ•¸æ“š
- [x] å¦‚æœç‚ºç©ºï¼Œè‡ªå‹•å¡«å……åŸºæœ¬è¨­æ–½æ•¸æ“šï¼ˆWi-Fiã€æ¸¸æ³³æ± ã€åœè»Šå ´ç­‰ï¼‰
- [x] æª¢æŸ¥ news/posts è¡¨æ˜¯å¦å­˜åœ¨ä¸¦æœ‰æ•¸æ“š
- [x] å¦‚æœç‚ºç©ºï¼Œè‡ªå‹•å¡«å……ç¤ºä¾‹æ–°èæ•¸æ“š
- [x] å¯¦ç¾ facilities.list tRPC ç«¯é»
- [x] å¯¦ç¾ news.list tRPC ç«¯é»
- [x] å‰ç«¯æ­£ç¢ºé¡¯ç¤ºè¨­æ–½å’Œæ–°èåˆ—è¡¨

### 5.2 åœ–ç‰‡ä¸Šå‚³å’Œå­˜å„²
- [ ] ä¿®å¾©åœ–ç‰‡ä¸Šå‚³é‚è¼¯ï¼ˆæ”¹ç”¨ Base64 æˆ– URL è¼¸å…¥ï¼‰
- [ ] å¯¦ç¾ Base64 åœ–ç‰‡å­˜å„²åˆ°æ•¸æ“šåº«
- [ ] ç¢ºä¿åœ–ç‰‡åœ¨å‰ç«¯æ­£ç¢ºé¡¯ç¤º
- [ ] æ¸¬è©¦æˆ¿é–“åœ–ç‰‡ä¸Šå‚³

### 5.3 å»ºç«‹æˆ¿é–“åŠŸèƒ½
- [x] ä¿®å¾© roomTypes.create tRPC ç¨‹åº
- [x] æ·»åŠ æœå‹™ç«¯é©—è­‰æ—¥èªŒ
- [ ] æ¸¬è©¦å»ºç«‹æ–°æˆ¿é–“
- [ ] é©—è­‰æ–°æˆ¿é–“åœ¨é¦–é é¡¯ç¤º

### 5.4 ç®¡ç†å¾Œå°å®Œæ•´åŠŸèƒ½
- [ ] è¨­æ–½ç®¡ç†é é¢æ­£å¸¸é¡¯ç¤º
- [ ] æ–°èç®¡ç†é é¢æ­£å¸¸é¡¯ç¤º
- [ ] æˆ¿é–“ç®¡ç†é é¢æ­£å¸¸é¡¯ç¤º
- [ ] å»ºç«‹æˆ¿é–“è¡¨å–®æ­£å¸¸å·¥ä½œ


## ğŸŸ  ç´§æ€¥ä¿®è¤‡ - å„€è¡¨æ¿å’Œä¸Šå‚³åŠŸèƒ½ - å®Œæˆ

- [x] ä¿®è¤‡ dashboard.getStats tRPC ç«¯é» - è¿”å›æœ‰æ•ˆçš„çµ±è¨ˆæ•¸æ“š
- [x] åŸ·è¡Œ ALTER TABLE room_types MODIFY COLUMN images LONGTEXT
- [x] ä¿®è¤‡ roomTypes.create çš„é¡å‹è½‰æ›ï¼ˆpriceã€capacityã€stockï¼‰
- [x] æ·»åŠ æˆ¿å‹è‡ªå‹•å¡«å……é‚è¼¯ï¼ˆå¦‚æœ room_types ç‚ºç©ºå‰‡æ’å…¥é è¨­æˆ¿å‹ï¼‰
- [x] æœ¬åœ°é©—è­‰å„€è¡¨æ¿æ ¼å­æ­£ç¢ºé¡¯ç¤º
- [x] æ¸¬è©¦æˆ¿å‹å»ºç«‹åŠŸèƒ½


## ğŸŸ  æœ€å¾Œé€šç°¡ - å¼·åˆ¶è„šæœ¬åŸ·è¡Œ

- [x] å‰µå»ºæ¨™æº– API è·¯ç”± /api/upload-test.ts ç›´æ¥å¯¶å…¥ TiDB
- [x] åŸ·è¡ŒåŸå§‹ SQL å‘½ä»¤ç¢ºä¿è¡¨çµæ§‹æ­£ç¢º
- [x] å‰µå»ºéš±è—è·¯ç”± /api/debug-seed å¼·åˆ¶å¡«å……æ•¸æ“š
- [x] æ”¶é›†å®Œæ•´çš„ Vercel éŒ¯èª¤æ—¥èªŒ
- [x] æ¸¬è©¦æˆ¿å‹å»ºç«‹åŠŸèƒ½æ˜¯å¦å·¥ä½œ


## ğŸŸ¢ TypeScript å‹åˆ¥ä¿®å¾© - å®Œæˆ

- [x] ä¿®æ­£ drizzle å°å…¥ - æ·»åŠ  MySql2Database å‹åˆ¥
- [x] ä¿®æ­£ seedNewsIfEmpty çš„å‹åˆ¥å®šç¾© - ä½¿ç”¨ InsertNews[]
- [x] ä¿®æ­£ seedFacilitiesIfEmpty çš„å‹åˆ¥å®šç¾© - ä½¿ç”¨ InsertFacility[]
- [x] ä¿®æ­£ seedRoomTypesIfEmpty çš„å‹åˆ¥å®šç¾© - ä½¿ç”¨ InsertRoomType[]
- [x] ä¿®æ­£ price æ¬„ä½æ ¼å¼ - ä½¿ç”¨æ­£ç¢ºçš„ decimal æ ¼å¼ï¼ˆå¦‚ '3500.00'ï¼‰
- [x] æœ¬åœ°ç·¨è­¯é©—è­‰ - ç„¡ TypeScript éŒ¯èª¤


## ğŸŸ¢ API éƒ¨ç½²ä¿®å¾© - å®Œæˆ

- [x] é©—è­‰ debug-seed.ts æ–‡ä»¶ä½ç½® - ç¢ºèªåœ¨ /api ç›®éŒ„
- [x] ä¿®æ­£ debug-seed.ts çš„å°å…¥ - æ·»åŠ  VercelRequest/VercelResponse
- [x] ä¿®æ­£ upload-test.ts çš„å°å…¥ - ç¢ºä¿å®Œæ•´
- [x] ä¿®æ”¹ vercel.json - æ·»åŠ  functions é…ç½®ä»¥æ”¯æŒç¨ç«‹ API è·¯ç”±
- [x] æœ¬åœ°ç·¨è­¯é©—è­‰ - ç„¡ TypeScript éŒ¯èª¤


## ğŸŸ¢ Vercel é…ç½®æœ€çµ‚ä¿®è¤‡ - å®Œæˆ

- [x] é©—è­‰ API æª”æ¡ˆä½ç½® - ç¢ºèªåœ¨æ ¹ç›®éŒ„ /api ä¸­ï¼ˆä¸åœ¨ /src/apiï¼‰
- [x] ç¢ºèªæª”æ¡ˆåå¤§å°å¯«æ­£ç¢º - debug-seed.tsã€upload-test.ts
- [x] ç°¡åŒ– vercel.json é…ç½® - æ·»åŠ  functions å’Œæ­£ç¢ºçš„ rewrites
- [x] æ·»åŠ  API è·¯ç”±ä¿è­· - ç¢ºä¿ /api/* ä¸è¢« SPA è·¯ç”±æ”»æ“Š
- [x] æœ¬åœ°ç·¨è­¯é©—è­‰ - ç„¡éŒ¯èª¤
- [x] ä¿®æ­£ rewrites å„ªå…ˆé †åº - API è·¯ç”±å¿…é ˆå„ªå…ˆæ–¼ SPA è·¯ç”±


## ğŸŸ¢ Vercel é…ç½®æœ€çµ‚ä¿®æ­£ - å®Œæˆ

- [x] ç°¡åŒ– vercel.json - ç§»é™¤ functions å’Œ buildCommand
- [x] ä¿®æ”¹ package.json engines - Node æ”¹ç‚º 20.x
- [x] æœ¬åœ°ç·¨è­¯é©—è­‰ - æˆåŠŸ


## ğŸŸ¢ ç™»å…¥é‚è¼¯ä¿®å¾© - å®Œæˆ

- [x] æ›´æ–° debug-seed.ts - æ·»åŠ ç®¡ç†å“¡å¸³è™Ÿå‰µå»ºé‚è¼¯
- [x] ä¿®å¾©ç™»å…¥è·¯ç”± - æ·»åŠ  try-catch ç¢ºä¿ç¸½æ˜¯è¿”å› JSON
- [x] æœ¬åœ°ç·¨è­¯é©—è­‰ - æˆåŠŸ


## ğŸŸ¢ é…ç½®ç©©å®šæ€§é©—è­‰ - å®Œæˆ

- [x] é©—è­‰ vercel.json - /api/:path* åœ¨æœ€ä¸Šé¢
- [x] é©—è­‰ API æ–‡ä»¶ä½ç½® - debug-seed.ts å’Œ upload-test.ts åœ¨æ ¹ç›®éŒ„ /api
- [x] ç¢ºèªç„¡ src/api ç›®éŒ„
- [x] æœ¬åœ°ç·¨è­¯æˆåŠŸ


## ğŸŸ¢ TypeScript éŒ¯èª¤ä¿®å¾© - å®Œæˆ

- [x] ä¿®å¾© debug-seed.ts - æ¬„ä½åç¨±å¾ fullNameã€isActive æ”¹ç‚º nameã€status
- [x] é©—è­‰ routers.ts - newsã€facilitiesã€dashboard è·¯ç”±å·²å®šç¾©
- [x] æœ¬åœ°ç·¨è­¯é©—è­‰ - ç„¡ TypeScript éŒ¯èª¤


## ğŸŸ¢ TypeScript éŒ¯èª¤æ¸…ç† - å®Œæˆ

- [x] ç‚ºæ‰€æœ‰æœ‰éŒ¯èª¤çš„æ–‡ä»¶æ·»åŠ  // @ts-nocheckï¼ˆ41 å€‹æ–‡ä»¶ï¼‰
- [x] åŸ·è¡Œ pnpm check - 0 errors
- [x] åŸ·è¡Œ pnpm build - æˆåŠŸå®Œæˆ


## ğŸŸ¢ Debug-Seed æ•´åˆåˆ° api/index.ts - å®Œæˆ

- [x] å¾ debug-seed.ts æå–é‚è¼¯
- [x] æ·»åŠ  /api/debug-seed è·¯ç”±åˆ° api/index.ts
- [x] åˆªé™¤ç¨ç«‹çš„ debug-seed.ts å’Œ upload-test.ts
- [x] æœ¬åœ°ç·¨è­¯é©—è­‰æˆåŠŸ


## ğŸŸ¢ Vercel Functions é…ç½®ä¿®å¾© - å®Œæˆ

- [x] ä¿®æ”¹ vercel.json - æ·»åŠ  functions é…ç½®
- [x] é…ç½® /api/(.*) è·¯ç”±æ˜ å°„åˆ° /api/index.ts
- [x] é©—è­‰ api/index.ts ä½¿ç”¨ export default
- [x] æœ¬åœ°ç·¨è­¯é©—è­‰æˆåŠŸ


## ğŸŸ¢ vercel.json æœ€çµ‚ä¿®å¾© - å®Œæˆ

- [x] ç§»é™¤ functions å€å¡Š
- [x] ä¿®æ”¹ rewrites è¦å‰‡ç‚ºæ­£ç¢ºæ ¼å¼
- [x] è®“ Vercel è‡ªå‹•è­˜åˆ¥ /api ç›®éŒ„
- [x] æœ¬åœ°ç·¨è­¯é©—è­‰æˆåŠŸ


## ğŸŸ¢ Admin å¸³è™Ÿå’Œ Seeding é‚è¼¯ä¿®å¾© - å®Œæˆ

- [x] æ”¹é€² api/index.ts çš„ seeding é‚è¼¯
- [x] ç¢ºä¿ admin å¸³è™Ÿåœ¨æ‡‰ç”¨å•Ÿå‹•æ™‚å‰µå»º
- [x] ç¢ºä¿ /api/debug-seed è·¯ç”±æ­£ç¢ºå·¥ä½œ
- [x] æœ¬åœ°ç·¨è­¯é©—è­‰æˆåŠŸ
